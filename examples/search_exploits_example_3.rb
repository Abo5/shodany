require 'shodany'
require 'json'

# Initialize with your Shodan API key
client = Shodany.new("YOUR-TOKEN")
results_json = client.search_exploits("windows")

# Parse the JSON string into a Ruby hash
results = JSON.parse(results_json)

# Check if 'matches' is present and is an array
if results['matches'].is_a?(Array)
  results['matches'].each do |match|
    match.each do |key, value|
      if value.is_a?(Array)
        puts "#{key}: #{value.join(', ')}"
      else
        puts "#{key}: #{value}"
      end
    end
    puts "\n"  # Adds a new line for readability between entries
  end
else
  puts "'matches' is not an array"
end
